# SFTP Configuration for chrooted users
# Generated by Ansible - Based on vsftpd_container configuration

Port {{ sshd_port }}
Protocol {{ sshd_protocol }}
PermitRootLogin {{ 'yes' if sshd_permit_root_login else 'no' }}

PubkeyAuthentication {{ 'yes' if sshd_pubkey_authentication else 'no' }}
AuthorizedKeysFile .ssh/authorized_keys

PermitEmptyPasswords {{ 'yes' if sshd_permit_empty_passwords else 'no' }}
ChallengeResponseAuthentication {{ 'yes' if sshd_challenge_response_authentication else 'no' }}
UsePAM {{ 'yes' if sshd_use_pam else 'no' }}

# Logging Config
LogLevel {{ sshd_log_level }}
SyslogFacility {{ sshd_syslog_facility }}

# SFTP Config with logging, -l sets logging level to INFO
# QUIET, FATAL, ERROR, INFO, VERBOSE, DEBUG, DEBUG1, DEBUG2, DEBUG3
Subsystem sftp internal-sftp -l {{ sftp_log_level }}

AllowGroups {{ sshd_allow_groups | join(' ') }}

Match Group {{ ftp_user_group }}
  ChrootDirectory {{ sftp_chroot_directory }}
  AllowTCPForwarding {{ 'yes' if sftp_allow_tcp_forwarding else 'no' }}
  X11Forwarding {{ 'yes' if sftp_x11_forwarding else 'no' }}
  ForceCommand {{ sftp_force_command }}
  PasswordAuthentication {{ 'yes' if sftp_password_authentication else 'no' }}
  MaxSessions {{ sftp_max_sessions }}
